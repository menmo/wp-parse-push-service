!function(e){var s={};function t(a){if(s[a])return s[a].exports;var n=s[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=s,t.d=function(e,s,a){t.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,s){if(1&s&&(e=t(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var n in e)t.d(a,n,function(s){return e[s]}.bind(null,n));return a},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="",t(t.s=3)}([function(e,s){e.exports=writer},function(e,s){e.exports=substance},function(e,s,t){},function(e,s,t){"use strict";t.r(s);t(2);var a=t(1),n=t(0);class r extends a.Component{constructor(...e){super(...e),this.parsePluginHost=this.props.pluginConfigObject.pluginConfigObject.data.parsePluginHost,n.api.router.get("/api/resourceproxy",{url:`${this.parsePluginHost}/wp-admin/admin-ajax.php?action=pps_categories`}).then(e=>n.api.router.checkForOKStatus(e)).then(e=>n.api.router.toJson(e)).then(e=>{this.extendState({channels:this.state.channels.concat(e.map(({slug:e,name:s})=>({value:e,label:s})))})})}dispose(){}getInitialState(){return{channels:[{value:null,label:this.getLabel("skd-parse-channel-placeholder")}],selectedChannel:null}}didMount(){}render(e){const s=e("div").addClass("skd-parse-push"),t=e(n.UIDropdown,{options:this.state.channels,header:this.getLabel("skd-parse-channel"),onChangeList:e=>{this.extendState({selectedChannel:e})},isSelected:(e,s)=>s.value===this.state.selectedChannel}),a=e("input",{type:"text",name:"message",placeholder:this.getLabel("skd-parse-message-placeholder"),value:this.state.message}).addClass("form-control").on("change",e=>this.extendState({message:e.target.value})),r=n.api.newsItem.getPubStatus(),i=e(n.UIButton,{label:this.getLabel("skd-parse-send"),enabled:Boolean(this.state.selectedChannel)&&"stat:usable"===r.qcode}).on("click",()=>{this.sendPush()});return s.append([e("h2").append(this.getLabel("skd-parse-title")),t,e("h2").append(this.getLabel("skd-parse-message")),a,i]),s}sendPush(){var e=new URLSearchParams;e.append("action","pps_push_notification"),e.append("guid",n.api.newsItem.getGuid()),e.append("message",this.state.message||""),e.append("channel",this.state.selectedChannel),n.api.router.post("/api/resourceproxy",{url:`${this.parsePluginHost}/wp-admin/admin-ajax.php`,body:e}).then(e=>n.api.router.checkForOKStatus(e)).then(()=>n.api.ui.showNotification("se.skd.parsepush",this.getLabel("skd-parse-success-title"),this.getLabel("skd-parse-success-message"))).catch(e=>n.api.ui.showNotification("se.skd.parsepush",this.getLabel("skd-parse-error-title"),"0"!==e.message?e.message:this.getLabel("skd-parse-error-message")))}}var i={name:"skdparsepush",id:"se.skd.parsepush",configure:function(e,s){e.addToSidebar("Webb",s,r),e.addLabel("skd-parse-title",{en:"Mobile app push",sv:"Pushnotiser"}),e.addLabel("skd-parse-send",{en:"Send",sv:"Skicka"}),e.addLabel("skd-parse-message",{en:"Custom message",sv:"Egen text"}),e.addLabel("skd-parse-message-placeholder",{en:"Default is article title",sv:"Standard 채r artikelns rubrik"}),e.addLabel("skd-parse-channel",{en:"Channel",sv:"Kanal"}),e.addLabel("skd-parse-channel-placeholder",{en:"Select a channel",sv:"V채lj kanal"}),e.addLabel("skd-parse-success-title",{en:"Push message",sv:"Pushnotiser"}),e.addLabel("skd-parse-success-message",{en:"Your message has been sent",sv:"Ditt meddelande har nu skickats"}),e.addLabel("skd-parse-error-title",{en:"Error sending push",sv:"Fel vid pushutskick"}),e.addLabel("skd-parse-error-message",{en:"An unknown error occured",sv:"Ett ok채nt fel intr채ffade"})}};n.registerPlugin?Object(n.registerPlugin)(i):console.error("Register method not yet available")}]);